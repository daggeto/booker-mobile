!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(n){"use strict";n.provider("AjaxInterceptor",["$httpProvider",function(n){var o={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null};return{config:function(t){angular.extend(o,t),n.interceptors.push(["$rootScope","$q","$injector",function(n,t,r){return{request:function(t){return n.$broadcast("loading:show"),o.authorizationToken&&(t.headers[o.authorizationHeader]=o.authorizationToken),t},requestError:function(o){return n.$broadcast("loading:hide"),t.reject(o)},response:function(o){return n.$broadcast("loading:hide"),o},responseError:function(e){if(0==e.status){var i=e.config.url.split("/");if(i[2]!==o.fallbackIp){i[2]=o.fallbackIp,e.config.url=i.join("/");var a=r.get("$http");return a(e.config)}}return n.$broadcast("loading:hide"),t.reject(e)}}}])},$get:["$ionicPopup","$ionicLoading","$rootScope",function(n,t,r){var e=0,i=function(){0===e&&t.show({content:"Loading",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0,hideOnStateChange:!0}),e++},a=function(){e--,0==e?t.hide():0>e&&(e=0)};return{run:function(){o.stateChangeError&&r.$on("$stateChangeError",function(t,r,e,i,a,u){n.alert({title:o.title,content:u.message||o.defaultMessage})}),r.$on("loading:show",function(){i()}),r.$on("loading:hide",function(){a()})},setAuthorizationToken:function(n){o.authorizationToken=n},showLoading:function(){i()},hideLoading:function(){a()}}}]}}])}(angular.module("ionic-ajax-interceptor"));